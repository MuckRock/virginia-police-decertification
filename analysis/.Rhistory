last_name == "Williams" & first_name == "Dustin" ~ "Montgomery County Sheriff`s Office",
TRUE ~ agency))
prior_fixed <- prior %>%
left_join(prior_crosswalk, join_by(agency)) %>%
mutate(agency_name = case_when(is.na(crosswalk_correction) ~ agency, .default = crosswalk_correction))
reinstated_fixed <- reinstated %>%
left_join(reinstated_crosswalk, join_by(agency)) %>%
mutate(agency_name = case_when(is.na(crosswalk_correction) ~ agency, .default = crosswalk_correction))
certified_directory_join <- certified_officers %>%
right_join(agency_directory, join_by(place_of_employment == agency_name))
### WRITE TO FOLDER FOR ANALYSIS ###
write.csv(present_fixed, "../data/processed/analysis/present.csv")
write.csv(prior_fixed, "../data/processed/analysis/prior.csv")
write.csv(reinstated_fixed, "../data/processed/analysis/reinstated.csv")
write.csv(certified_directory_join, "../data/processed/analysis/certified_directory.csv")
present <- read.csv(here("data", "processed","analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","analysis", "certified_directory.csv")) %>%
select(-X)
# Dataframe that sums the total of number of decertifications for each year since law change
by_year_present <- present %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n()) %>%
# Remove two cases, one from 2025 since we don't have enough data and one from 2029 that is data error
filter(!year %in% c("2025", "2029"))
# Calculate the average num of decertifications yearly since law change: 76.5
mean_present <- mean(by_year_present$num)
# Dataframe that sums the total of number of decertifications for each year before law change
by_year_prior <- prior %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n())
# Dataframe of all years of certifications for comparison
merge_years <- rbind(by_year_present, by_year_prior) %>%
# Fill in zero for years not included in data: 2001, 2002, 2003, 2004, 2006, 2007, 2008, 2009, 2011
complete(year = seq(min(year), max(year), by = 1),fill = list(num =0)) %>%
arrange(desc(year))
# Export data to csv for Datawrapper chart
write.csv(merge_years, "../data/processed/vis/all_years.csv")
# Dataframe of total number of decertifications at each agency that has decertified an officer since 2021
present_agency_totals <- present %>%
group_by(agency_name) %>%
summarize(decerts = n())
# Dataframe of total number of decertifications at each agency that has decertified an officer before 2021
prior_agency_totals <- prior %>%
group_by(agency_name) %>%
summarize(num = n())
# Dataframe of agencies that haven't decertified an officer since 2021
# Joins dataset of all law enforcement agencies with dataset of present decertifications
no_decertifications <- certified_directory %>%
anti_join(present, join_by(place_of_employment == agency_name)) %>%
select(agency_name = place_of_employment) %>%
mutate(decerts = 0)
all_agencies <- rbind(no_decertifications, present_agency_totals)
decert_bins <- all_agencies %>%
group_by(decerts) %>%
rename(num_decerts = decerts) %>%
summarize(num_agencies = n())
# total = 515
# 59
greater_than_one <- decert_bins %>%
filter(!num_decerts %in% c(0,1)) %>%
summarize(total = sum(num_agencies))
# 456
one_or_less <- decert_bins %>%
filter(num_decerts %in% c(0,1)) %>%
summarize(total = sum(num_agencies))
# Which agencies aren't in directory but are in decertifications
additional_agencies <- all_agencies %>%
select(agency_name) %>%
anti_join(certified_directory, join_by(agency_name == place_of_employment))
View(additional_agencies)
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)
present <- read.csv(here("data", "processed","analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","analysis", "certified_directory.csv")) %>%
select(-X)
# Dataframe that sums the total of number of decertifications for each year since law change
by_year_present <- present %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n()) %>%
# Remove two cases, one from 2025 since we don't have enough data and one from 2029 that is data error
filter(!year %in% c("2025", "2029"))
# Calculate the average num of decertifications yearly since law change: 76.5
mean_present <- mean(by_year_present$num)
# Dataframe that sums the total of number of decertifications for each year before law change
by_year_prior <- prior %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n())
# Dataframe of all years of certifications for comparison
merge_years <- rbind(by_year_present, by_year_prior) %>%
# Fill in zero for years not included in data: 2001, 2002, 2003, 2004, 2006, 2007, 2008, 2009, 2011
complete(year = seq(min(year), max(year), by = 1),fill = list(num =0)) %>%
arrange(desc(year))
# Export data to csv for Datawrapper chart
write.csv(merge_years, "../data/processed/vis/all_years.csv")
# Dataframe of total number of decertifications at each agency that has decertified an officer since 2021
present_agency_totals <- present %>%
group_by(agency_name) %>%
summarize(decerts = n())
# Dataframe of total number of decertifications at each agency that has decertified an officer before 2021
prior_agency_totals <- prior %>%
group_by(agency_name) %>%
summarize(num = n())
# Dataframe of agencies that haven't decertified an officer since 2021
# Joins dataset of all law enforcement agencies with dataset of present decertifications
no_decertifications <- certified_directory %>%
anti_join(present, join_by(place_of_employment == agency_name)) %>%
select(agency_name = place_of_employment) %>%
mutate(decerts = 0)
all_agencies <- rbind(no_decertifications, present_agency_totals)
decert_bins <- all_agencies %>%
group_by(decerts) %>%
rename(num_decerts = decerts) %>%
summarize(num_agencies = n())
# total = 515
# 59
greater_than_one <- decert_bins %>%
filter(!num_decerts %in% c(0,1)) %>%
summarize(total = sum(num_agencies))
# 456
one_or_less <- decert_bins %>%
filter(num_decerts %in% c(0,1)) %>%
summarize(total = sum(num_agencies))
# Which agencies aren't in directory but are in decertifications
additional_agencies <- all_agencies %>%
select(agency_name) %>%
anti_join(certified_directory, join_by(agency_name == place_of_employment))
View(decert_bins)
398/512
512-398
56/114
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# what to do about NAs?
top_ten_agencies <- present_agency_totals_cert %>%
slice_max(order_by = num_decerts, n = 10)
#write.csv(top_ten_agencies, "../data/processed/vis/top_agency_totals.csv")
View(present_agency_totals_cert)
View(certified_directory)
View(all_agencies)
View(present_agency_totals)
all_agecnies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
View(all_agecnies_totals)
all_agecnies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors)
all_agecnies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe that combines number of decertifications with number of certified officers and compares rank and percentile rank, for agencies that have decertified an officer
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe that combines decertifications with certified officers and compares rank, for all 513 agences, not just those that have decertified
all_agecnies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe of top ten agencies have decertified and officer for Datawrapper chart
top_ten_agencies <- present_agency_totals_cert %>%
slice_max(order_by = num_decerts, n = 10)
# Writing data to csv for Datawrapper
write.csv(top_ten_agencies, "../data/processed/vis/top_agency_totals.csv")
#| output: true
datatable(all_agencies_totals, filter = 'top', class = 'cell-border stripe order-column', extensions = 'Buttons',
rownames = FALSE,
options = list(
paging = TRUE,
searching = TRUE,
fixedColumns = TRUE,
autoWidth = TRUE,
ordering = TRUE,
dom = 'tB',
buttons = c('copy', 'csv', 'excel')
))
# Dataframe that combines decertifications with certified officers and compares rank, for all 513 agences, not just those that have decertified
all_agencies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
#| output: true
datatable(all_agencies_totals, filter = 'top', class = 'cell-border stripe order-column', extensions = 'Buttons',
rownames = FALSE,
options = list(
paging = TRUE,
searching = TRUE,
fixedColumns = TRUE,
autoWidth = TRUE,
ordering = TRUE,
dom = 'tB',
buttons = c('copy', 'csv', 'excel')
))
331/1788
1/5
View(prior)
# Dataframe of decertifications by agency prior to 2021
by_agency_prior <- prior %>%
group_by(agency_name) %>%
summarize(num = n())
#| output: true
datatable(by_agency_prior, filter = 'top', class = 'cell-border stripe order-column', extensions = 'Buttons',
rownames = FALSE,
options = list(
paging = TRUE,
searching = TRUE,
fixedColumns = TRUE,
autoWidth = TRUE,
ordering = TRUE,
dom = 'tB',
buttons = c('copy', 'csv', 'excel')
))
View(prior)
1270-248
331-248
# Dataframe of top ten agencies have decertified and officer for Datawrapper chart
five_or_over <- present_agency_totals_cert %>%
filter(num_decerts >= 5)
View(five_or_over)
View(decert_bins)
# Writing data to csv for Datawrapper
write.csv(five_or_over, "../data/processed/vis/top_agency_totals.csv")
# Writing data to csv for Datawrapper
write.csv(five_or_over, "../data/processed/vis/agencies_five_or_over.csv")
quarto publish netlify
76/17
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)
present <- read.csv(here("data", "processed","analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","analysis", "certified_directory.csv")) %>%
select(-X)
View(prior)
View(present)
View(certified_directory)
# Calculate the total number of certified officers
total_certified_officers <- sum(certified_directory$certified_officers_jailors)
# Calculate the total number of certified officers
total_certified_officers <- sum(certified_directory$certified_officers_jailors, na.rm = TRUE)
total_certified_officers <- n_distinct(certified_directory$place_of_employment)
# Calculate the total number of certified officers
total_certified_officers <- sum(certified_directory$certified_officers_jailors, na.rm = TRUE)
total_certified_agencies <- n_distinct(certified_directory$place_of_employment)
quarto publish netlify
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)
present <- read.csv(here("data", "processed","analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","analysis", "certified_directory.csv")) %>%
select(-X)
# Dataframe that sums the total of number of decertifications for each year since law change
by_year_present <- present %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n()) %>%
# Remove two cases, one from 2025 since we don't have enough data and one from 2029 that is data error
filter(!year %in% c("2025", "2029"))
# Calculate the average num of decertifications yearly since law change: 76.5
mean_present <- mean(by_year_present$num)
# Dataframe that sums the total of number of decertifications for each year before law change
by_year_prior <- prior %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n())
# Dataframe of all years of certifications for comparison
merge_years <- rbind(by_year_present, by_year_prior) %>%
# Fill in zero for years not included in data: 2001, 2002, 2003, 2004, 2006, 2007, 2008, 2009, 2011
complete(year = seq(min(year), max(year), by = 1),fill = list(num =0)) %>%
arrange(desc(year))
# Export data to csv for Datawrapper chart
write.csv(merge_years, "../data/processed/vis/all_years.csv")
# Calculate the total number of certified officers
total_certified_officers <- sum(certified_directory$certified_officers_jailors, na.rm = TRUE)
# Dataframe of total number of decertifications at each agency that has decertified an officer since 2021
present_agency_totals <- present %>%
group_by(agency_name) %>%
summarize(decerts = n())
# Dataframe of total number of decertifications at each agency that has decertified an officer before 2021
prior_agency_totals <- prior %>%
group_by(agency_name) %>%
summarize(num = n())
# Dataframe of agencies that haven't decertified an officer since 2021
# Joins dataset of all law enforcement agencies with dataset of present decertifications
no_decertifications <- certified_directory %>%
anti_join(present, join_by(place_of_employment == agency_name)) %>%
select(agency_name = place_of_employment) %>%
mutate(decerts = 0)
# Dataframe of all agencies that have and haven't had a decertification since 2021
all_agencies <- rbind(no_decertifications, present_agency_totals)
# Dataframe of number of decertifications grouped by how many agencies decertified that many officers
decert_bins <- all_agencies %>%
group_by(decerts) %>%
rename(num_decerts = decerts) %>%
summarize(num_agencies = n())
# Checking which agencies aren't in directory but are in decertifications
# We have 513 agencies total instead of 512 because one decertification seems to combine two agencies
additional_agencies <- all_agencies %>%
select(agency_name) %>%
anti_join(certified_directory, join_by(agency_name == place_of_employment))
# Dataframe of agencies that decertified more than one officer
greater_than_one_decert <- decert_bins %>%
filter(num_decerts > 1)
View(greater_than_one_decert)
total_greater_than_one <- sum(greater_than_one_decert$num_decerts)
56/(56+61
56/(56+61)
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)
present <- read.csv(here("data", "processed","analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","analysis", "certified_directory.csv")) %>%
select(-X)
# Dataframe that combines number of decertifications with number of certified officers and compares rank and percentile rank, for agencies that have decertified an officer
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe of total number of decertifications at each agency that has decertified an officer since 2021
present_agency_totals <- present %>%
group_by(agency_name) %>%
summarize(decerts = n())
# Dataframe of total number of decertifications at each agency that has decertified an officer before 2021
prior_agency_totals <- prior %>%
group_by(agency_name) %>%
summarize(num = n())
# Dataframe of agencies that haven't decertified an officer since 2021
# Joins dataset of all law enforcement agencies with dataset of present decertifications
no_decertifications <- certified_directory %>%
anti_join(present, join_by(place_of_employment == agency_name)) %>%
select(agency_name = place_of_employment) %>%
mutate(decerts = 0)
# Dataframe of all agencies that have and haven't had a decertification since 2021
all_agencies <- rbind(no_decertifications, present_agency_totals)
# Dataframe that combines number of decertifications with number of certified officers and compares rank and percentile rank, for agencies that have decertified an officer
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe that combines decertifications with certified officers and compares rank, for all 513 agences, not just those that have decertified
all_agencies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe of top ten agencies have decertified and officer for Datawrapper chart
five_or_over <- present_agency_totals_cert %>%
filter(num_decerts >= 5)
top_ten_agencies <- present_agency_totals_cert %>%
slice_max(order_by = num_decerts, n = 10)
# Writing data to csv for Datawrapper
write.csv(five_or_over, "../data/processed/vis/agencies_five_or_over.csv")
write.csv(top_ten, "../data/processed/vis/top_ten.csv")
top_ten <- present_agency_totals_cert %>%
slice_max(order_by = num_decerts, n = 10)
# Writing data to csv for Datawrapper
write.csv(five_or_over, "../data/processed/vis/agencies_five_or_over.csv")
write.csv(top_ten, "../data/processed/vis/top_ten.csv")
# Dataframe that sums the total of number of decertifications for each year since law change
by_year_present <- present %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n()) %>%
# Remove two cases, one from 2025 since we don't have enough data and one from 2029 that is data error
filter(!year %in% c("2025", "2029"))
# Calculate the average num of decertifications yearly since law change: 76.5
mean_present <- mean(by_year_present$num)
# Dataframe that sums the total of number of decertifications for each year before law change
by_year_prior <- prior %>%
mutate(year = year(fixed_date)) %>%
group_by(year) %>%
summarize(num = n())
# Dataframe of all years of certifications for comparison
merge_years <- rbind(by_year_present, by_year_prior) %>%
# Fill in zero for years not included in data: 2001, 2002, 2003, 2004, 2006, 2007, 2008, 2009, 2011
complete(year = seq(min(year), max(year), by = 1),fill = list(num =0)) %>%
arrange(desc(year)) %>%
filter(year >= 2010)
# Export data to csv for Datawrapper chart
write.csv(merge_years, "../data/processed/vis/all_years.csv")
View(merge_years)
library(tidyverse)
library(here)
library(janitor)
library(ggplot2)
library(plotly)
library(DT)
library(lubridate)
present <- read.csv(here("data", "processed","analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","analysis", "certified_directory.csv")) %>%
select(-X)
# Dataframe of total number of decertifications at each agency that has decertified an officer since 2021
present_agency_totals <- present %>%
group_by(agency_name) %>%
summarize(decerts = n())
# Dataframe of total number of decertifications at each agency that has decertified an officer before 2021
prior_agency_totals <- prior %>%
group_by(agency_name) %>%
summarize(num = n())
# Dataframe of agencies that haven't decertified an officer since 2021
# Joins dataset of all law enforcement agencies with dataset of present decertifications
no_decertifications <- certified_directory %>%
anti_join(present, join_by(place_of_employment == agency_name)) %>%
select(agency_name = place_of_employment) %>%
mutate(decerts = 0)
# Dataframe of all agencies that have and haven't had a decertification since 2021
all_agencies <- rbind(no_decertifications, present_agency_totals)
# Dataframe that combines number of decertifications with number of certified officers and compares rank and percentile rank, for agencies that have decertified an officer
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe that combines decertifications with certified officers and compares rank, for all 513 agences, not just those that have decertified
all_agencies_totals <- all_agencies %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = decerts, certified_officers_jailors) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# Dataframe of top ten agencies have decertified and officer for Datawrapper chart
five_or_over <- present_agency_totals_cert %>%
filter(num_decerts >= 5)
top_ten <- present_agency_totals_cert %>%
slice_max(order_by = num_decerts, n = 10)
# Writing data to csv for Datawrapper
write.csv(five_or_over, "../data/processed/vis/agencies_five_or_over.csv")
write.csv(top_ten, "../data/processed/vis/top_ten.csv")
write.csv(present_agency_totals_cert, "all_agencies_total_cert.csv")
write.csv(present_agency_totals_cert, "../data/processed/vis/all_agencies_total_cert.csv")
View(top_ten)

present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv"))
library(tidyverse)
library(here)
library(janitor)
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv"))
prior <- read.csv(here("data", "processed","clean_for_analysis", "priort.csv"))
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv"))
prior <- read.csv(here("data", "processed","clean_for_analysis", "prior.csv"))
reinstated <- read.csv(here("data", "processed","clean_for_analysis", "reinstated.csv"))
certified_directory <- read.csv(here("data", "processed","clean_for_analysis", "certified_directory.csv"))
library(tidyverse)
library(here)
library(janitor)
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv"))
prior <- read.csv(here("data", "processed","clean_for_analysis", "prior.csv"))
reinstated <- read.csv(here("data", "processed","clean_for_analysis", "reinstated.csv"))
certified_directory <- read.csv(here("data", "processed","clean_for_analysis", "certified_directory.csv"))
View(present)
View(present)
View(present)
present_agency_totals <- present %>%
group_by(agency_name) %>%
summarize(num = n())
View(present_agency_totals)
library(ggplot2)
pres_hist <- ggplot(present_agency_totals, aes(x=num)) +
geom_histogram()
ggplot(present_agency_totals, aes(x=num)) +
geom_histogram()
library(plotly)
pres_hist <- ggplot(present_agency_totals, aes(x=num)) +
geom_histogram()
plotly(pres_hist)
ggplotly(pres_hist)
View(present)
View(certified_directory)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment))
View(present_agency_totals_cert)
View(certified_directory)
View(present)
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv")) %>%
select(-2)
View(present)
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv")) %>%
select(-X)
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv")) %>%
select(-X, -...1)
View(prior)
View(reinstated)
View(certified_directory)
present <- read.csv(here("data", "processed","clean_for_analysis", "present.csv")) %>%
select(-X, -...1)
prior <- read.csv(here("data", "processed","clean_for_analysis", "prior.csv")) %>%
select(-X, -...1)
reinstated <- read.csv(here("data", "processed","clean_for_analysis", "reinstated.csv")) %>%
select(-X, -...1)
certified_directory <- read.csv(here("data", "processed","clean_for_analysis", "certified_directory.csv")) %>%
select(-X)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment))
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment))
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num)
View(present_agency_totals)
View(present_agency_totals_cert)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) #%>%
View(present_agency_totals_cert)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100), digits = 0)
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 0))
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2))
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2))
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(num_decerts, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2))
# what to do about NAs?
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2))
# what to do about NAs?
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min"))
# what to do about NAs?
present_agency_totals_cert <- present_agency_totals %>%
left_join(certified_directory, join_by(agency_name == place_of_employment)) %>%
select(agency_name, num_decerts = num, certified_officers_jailors) %>%
mutate(percentile_decert = round(rank(num_decerts, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(size_rank = rank(-certified_officers_jailors, ties.method = "min")) %>%
mutate(percentile_size = round(rank(certified_officers_jailors, ties.method = "min") / nrow(present_agency_totals) *100, digits = 2)) %>%
mutate(decert_rank = rank(-num_decerts, ties.method = "min"))
# what to do about NAs?
